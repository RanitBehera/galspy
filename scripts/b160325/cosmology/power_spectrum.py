import numpy
import matplotlib.pyplot as plt
import os

POWER_DIR = "/mnt/home/student/cranit/NINJA/simulations/L150N2040/SNAPS/PowerSpectrum"
REDSHIFTS = [10,8]
h=0.6736

FILENAMES = ["powerspectrum-"+str(numpy.round(1/(1+z),4))+".txt" for z in REDSHIFTS]

for z,fn in zip(REDSHIFTS,FILENAMES):
    filepath = POWER_DIR + os.sep + fn
    k,P,N,Pz0 = numpy.loadtxt(filepath).T
    plt.plot(k,P,label=f"z={z}")


# ASTRID
# z=8
x = [-1.593558282208589, -1.418711656441718, -1.289877300613497, -1.1840490797546013, -1.1012269938650308, -1.0322085889570551, -0.9723926380368099, -0.8757668711656441, -0.8159509202453987, -0.7699386503067485, -0.7147239263803681, -0.6273006134969326, -0.5720858895705521, -0.49386503067484655, -0.41104294478527603, -0.3190184049079754, -0.23619631901840488, -0.1257668711656441, 0.04447852760736204, 0.16871165644171793, 0.2837423312883436, 0.39877300613496947, 0.5368098159509203, 0.7024539877300615, 0.8404907975460123, 1.0935582822085892, 1.3144171779141107, 1.5306748466257671, 1.710122699386503, 1.857361963190184, 2.0092024539877302, 2.0966257668711656, 2.151840490797546, 2.1932515337423317, 2.2898773006134974]
y = [2.6428571428571423, 2.5306122448979584, 2.3775510204081627, 2.3061224489795915, 2.224489795918367, 2.1224489795918364, 1.9897959183673466, 1.908163265306122, 1.7755102040816322, 1.6734693877551017, 1.6326530612244898, 1.4591836734693873, 1.387755102040816, 1.204081632653061, 1.0612244897959178, 0.8775510204081631, 0.693877551020408, 0.47959183673469363, 0.1020408163265305, -0.14285714285714324, -0.41836734693877586, -0.6734693877551021, -0.9693877551020411, -1.295918367346939, -1.5816326530612246, -2.0714285714285716, -2.428571428571429, -2.7857142857142856, -3.061224489795918, -3.326530612244898, -3.5, -3.571428571428571, -3.5408163265306123, -3.5918367346938775, -3.479591836734694]
X=numpy.power(10,x)
Y=numpy.power(10,y)
plt.plot(X,Y,'--',label="Astrid (z=8)")




plt.xscale('log')
plt.yscale('log')
plt.xlabel('k')
plt.ylabel('P(k)')
plt.legend()
plt.show()




